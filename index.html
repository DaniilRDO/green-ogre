<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>SECURE TERMINAL</title>

<style>
body {
    background: black;
    color: #00ff66;
    font-family: monospace;
    padding: 20px;
}

.hidden { display: none; }

#terminal {
    white-space: pre-wrap;
    min-height: 200px;
    margin-bottom: 20px;
}

input, button {
    background: black;
    color: #00ff66;
    border: 1px solid #00ff66;
    font-family: monospace;
    padding: 6px;
}
    
#timer {
    font-size: 26px;
    margin-bottom: 15px;
}

.panic {
    background: #200;
    color: red;
    animation: blink 1s infinite;
}

.fake-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 25px;
}

.fake-box label {
    display: block;
    margin-bottom: 6px;
    text-align: center;
    opacity: 0.7;
}

.quiz-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}

.light {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #300;
}
.light.green { background: #00ff66; }
.light.red { background: red; }

.screamer {
    position: fixed;
    inset: 0;
    background: black;
    z-index: 999;
    display: flex;
    justify-content: center;
    align-items: center;
}
.screamer img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}
</style>
</head>

<body>

<div id="timer">10:00</div>
<div id="terminal"></div>

<input id="input" placeholder="ENTER CODE">

<div id="fakeFields" class="hidden"></div>
<div id="quiz" class="hidden"></div>

<audio id="beep" src="beep.mp3"></audio>
<audio id="scream1" src="test.mp3"></audio>
<audio id="screamEnd" src="endtimes.mp3"></audio>

<script>
let stage = 1;
let timeLeft = 600;
let timerInterval;

const terminal = document.getElementById("terminal");
const input = document.getElementById("input");
const timerDisplay = document.getElementById("timer");
const beep = document.getElementById("beep");

function typeText(text, cb) {
    let i = 0;
    terminal.innerHTML = "";
    const interval = setInterval(() => {
        terminal.innerHTML += text[i++];
        if (i >= text.length) {
            clearInterval(interval);
            if (cb) cb();
        }
    }, 18);
}

function startTimer() {
    // Очищуємо старий таймер, щоб не було прискорення
    if (timerInterval) clearInterval(timerInterval); 
    
    timerInterval = setInterval(() => {
        timeLeft--;
        if (timeLeft <= 60) document.body.classList.add("panic");
        if (timeLeft <= 0) endGame();

        const m = String(Math.floor(timeLeft/60)).padStart(2,"0");
        const s = String(timeLeft%60).padStart(2,"0");
        timerDisplay.textContent = `${m}:${s}`;
    }, 1000);
}

function screamer(audioId, imgName) {
    const div = document.createElement("div");
    div.className = "screamer";
    div.innerHTML = `<img src="${imgName}.jpg">`;
    document.body.appendChild(div);
    const sound = document.getElementById(audioId);
    if(sound) {
        sound.currentTime = 0;
        sound.play();
    }
    setTimeout(()=>div.remove(), 1500);
}

function endGame() {
    clearInterval(timerInterval);
    screamer("screamEnd", "endtimes");
}

input.addEventListener("keydown", e => {
    if (e.key !== "Enter") return;
    const code = input.value.toUpperCase();
    input.value = "";
    
    // Глобальні коди
    if (code === "TEST") screamer("scream1", "test");
    if (code === "TIME+") timeLeft += 300;

    advance(code);
});

function advance(code) {
    if (stage === 1 && code === "НЕТУРУЧЕКНЕТКОНФЕТОК") {
        stage = 2;
        input.classList.add("hidden");
        stage2();
    }
}

/* ===== ЕТАП 2 ===== */
function stage2() {
    const stage2Text = `Молодець, ти віднайшов перший код, але поки що ми надто далеко від правди (крівди). 

Ми перехопили повідомлення, яке хтось дуже не хотів, щоб ви прочитали.

Воно зашифроване примітивним, але ефективним методом.
Його використовували ще тоді, коли Рим не підозрював,
що колись зʼявиться Шрек.

Судак-тудак.....
Щось не так.... здається наші пр.... як.......баа..г..
АГЕНТ! ось перех.... згадай.... 4 роки.... майже.... вище...

*NJ CPPPNCPP*

`;
    typeText(stage2Text, createFieldsStage2);
}

function createFieldsStage2() {
    const fields = document.createElement("div");
    fields.id = "stage2-container";
    const labels = ["ПОЛЕ1", "ПОЛЕ2", "ПОЛЕ3", "ПОЛЕ4", "ПОЛЕ5"];
    
    labels.forEach((label, i) => {
        const box = document.createElement("div");
        box.innerHTML = `<span>${label}: </span>`;
        const fInput = document.createElement("input");
        fInput.onkeydown = e => {
            if (e.key === "Enter") {
                if (fInput.value.toUpperCase() === "MI BOOOMBOO" && i === 2) {
                    fields.remove();
                    stage = 3;
                    stage3();
                } else {
                    timeLeft -= 60;
                    fInput.value = "";
                    screamer("scream1", "test");
                }
            }
        };
        box.appendChild(fInput);
        fields.appendChild(box);
    });
    terminal.appendChild(fields);
}

/* ===== ЕТАП 3 ===== */
function stage3() {
    const stage3Text = `
Йоу, бейба, відкрий пакунок під номером 2, ти це точно заслуговуєш. До речі бачив мої скриті послання? Сподіваюсь ти вмієш бачити скриті речі.

Час спливає, тому я думаю я дам тобі можливість поповнити його, ти ж цього хочеш? 

Тепер в тебе буде шанс 50/50, так би мовити сімпл-дімпл або попит.

В одне ти маєш ввести код на час, в інший код для продовження на наступний рівень. 
Якщо перепутаєш коди місцями, отримаєш штраф.

Тобі треба послухати запис, він трошки довгий, але звертай увагу на дрібні деталі, речі які він перераховує. 
Щось точно зайве. 
Абрівіатура допоможе тобі знайти сімпл, 
дімпл вкаже тобі шлях, тут прямим текстом. 
Але пам'ятаєш на якій мові коди?

Попит найскладніше, бо тобі треба вміти рахувати, як саме? 
усе чуте це 1 а порожнеча між ними це 2.  
Якщо це складно для тебе, то не переймайся, бо загальне множення-39 дасть дату в яку хтось програв, а хтось переміг.
Але не кожен переможений зникає з історії, 
подумай про це.
`;

    typeText(stage3Text, () => {
        // Створюємо аудіоплеєр
        const audioControl = document.createElement("div");
        audioControl.innerHTML = `
            <p style="color:yellow">ЗАПИС_03.MP3</p>
            <button onclick="document.getElementById('scream1').play()">ВКЛЮЧИТИ ЗАПИС</button>
            <br><br>
        `;
        
        // Створюємо два поля
        const container = document.createElement("div");
        container.innerHTML = `
            <div style="margin-bottom:10px">
                <label>СІМПЛ-ДІМПЛ: </label>
                <input id="simpleInput" placeholder="???">
            </div>
            <div>
                <label>ПОПИТ: </label>
                <input id="popitInput" placeholder="???">
            </div>
        `;

        terminal.appendChild(audioControl);
        terminal.appendChild(container);

        const sInput = document.getElementById("simpleInput");
        const pInput = document.getElementById("popitInput");

        // Логіка для СІМПЛ-ДІМПЛ (Код на час)
        sInput.onkeydown = e => {
            if (e.key === "Enter") {
                if (sInput.value.toUpperCase() === "TERRARIACOMPASS") {
                    timeLeft += 600; // +10 хвилин
                    sInput.disabled = true;
                    sInput.style.color = "gray";
                    terminal.innerHTML += "<p style='color:cyan'>ЧАС ПОПОВНЕНО!</p>";
                } else {
                    screamer("scream1", "test");
                    timeLeft -= 60;
                }
            }
        };

        // Логіка для ПОПИТ (Код на продовження)
        pInput.onkeydown = e => {
            if (e.key === "Enter") {
                if (pInput.value.toUpperCase() === "GERMANY") {
                    stage = 4;
                    terminal.innerHTML = "ЕТАП 3 ЗАВЕРШЕНО. ПЕРЕХІД...";
                    setTimeout(stage4, 2000); // Перехід до вашої вікторини
                } else {
                    screamer("scream1", "test");
                    timeLeft -= 60;
                }
            }
        };
    });
}


/* ===== ЕТАП 4 ===== */
function stage4() {
    terminal.innerHTML = ""; // Очищуємо термінал
    
    const stage4Text = `
Звіт №47-А
Аналітик: ███████

У ході дослідження обʼєкта GREEN OGRE було зафіксовано численні відхилення.
Деякі співробітники повідомляють про зелені силуети.
Інші — про тварин, що спостерігають.
Частина персоналу почала безпричинно сміятися.

Перед усім, можеш відкрити пакунок 3, в ньому буде пояснення що робити з цим текстом далі:

<i style="opacity: 0.8">"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."</i>
<i style="opacity: 0.8">"Нет никого, кто любил бы боль саму по себе, кто искал бы её и кто хотел бы иметь её просто потому, что это боль.."</i>

Проснувшись однажды утром после беспокойного сна, Грегор Замза обнаружил, что он у себя в постели превратился в страшное насекомое. 
Лежа на панцирнотвердой спине, он видел, стоило ему приподнять голову, свой коричневый, выпуклый, разделенный дугообразными чешуйками живот, на верхушке которого еле держалось готовое вот-вот окончательно сползти одеяло. 
Его многочисленные, убого тонкие по сравнению с остальным телом ножки беспомощно копошились у него перед глазами. «Что со мной случилось?» – подумал он. 
Это не было сном. Его комната, настоящая, разве что слишком маленькая, но обычная комната, мирно покоилась в своих четырех хорошо знакомых стенах. 
Над столом, где были разложены распакованные образцы сукон – Замза был коммивояжером, – висел портрет, который он недавно вырезал из иллюстрированного журнала и вставил в красивую золоченую рамку. 
На портрете была изображена дама в меховой шляпе и боа, она сидела очень прямо и протягивала зрителю тяжелую меховую муфту, в которой целиком исчезала ее рука. 
Затем взгляд Грегора устремился в окно, и пасмурная погода – слышно было, как по жести подоконника стучат капли дождя – привела его и вовсе в грустное настроение. 
«Хорошо бы еще немного поспать и забыть всю эту чепуху», – подумал он, но это было совершенно неосуществимо, он привык спать на правом боку, а в теперешнем своем состоянии он никак не мог принять этого положения. 
С какой бы силой ни поворачивался он на правый бок, он неизменно сваливался опять на спину. Закрыв глаза, чтобы не видеть своих барахтающихся ног, он проделал это добрую сотню раз и отказался от этих попыток только тогда, когда почувствовал какую-то неведомую дотоле, тупую и слабую боль в боку. 
«Ах ты, господи, – подумал он, – какую я выбрал хлопотную профессию! Изо дня в день в разъездах. Деловых волнений куда больше, чем на месте, в торговом доме, а кроме того, изволь терпеть тяготы дороги, думай о расписании поездов, мирись с плохим, нерегулярным питанием,

Знайшов слово - переклав - записав з заходу на схід.
`;

    typeText(stage4Text, () => {
        // Створюємо поле вводу спеціально для 4 етапу
        const inputContainer = document.createElement("div");
        inputContainer.style.marginTop = "20px";
        inputContainer.innerHTML = `
            <input id="inputStage4" placeholder="ENTER KEYWORD" style="width: 250px;">
        `;
        terminal.appendChild(inputContainer);

        const input4 = document.getElementById("inputStage4");
        input4.focus();

        input4.onkeydown = e => {
            if (e.key === "Enter") {
                const val = input4.value.toUpperCase().trim();
                if (val === "EYES") {
                    stage = 5;
                    terminal.innerHTML = "<p style='color:lime'>ДОСТУП ДО ЕТАПУ 5 ВІДКРИТО...</p>";
                    setTimeout(stage5, 2000); 
                } else {
                    screamer("scream1", "test"); // Скример за помилку
                    timeLeft -= 45;
                    input4.value = "";
                }
            }
        };
    });
}


    

    
// Початковий запуск
typeText("АГЕНТЕ... Система чекає на КОД 1...", startTimer);

// Запуск першої сцени
typeText(`АГЕНТЕ, система дала збій... Шукайте код у Конверті №1.`, startTimer);

function stage4() {
    const quiz = document.getElementById("quiz");
    quiz.classList.remove("hidden");
    quiz.innerHTML="";

    const q = [
        ["Повна назва ДДМА","ДОНБАСЬКА ДЕРЖАВНА МАШИНОБУДІВНА АКАДЕМІЯ"],
        ["Те, що неможливо продати","СЛОН"],
        ["Шкода гачка","150"],
        ["Відеокарта","GTX 4060"],
        ["Що в кармані","НІЧОГО"],
        ["Традиційний подарунок","АНТИСТРЕС"],
        ["Код","CODE4"]
    ];

    q.forEach(([t,a])=>{
        const d=document.createElement("div");
        d.className="quiz-item";
        const i=document.createElement("input");
        i.placeholder=t;
        const l=document.createElement("div");
        l.className="light";
        i.onkeydown=e=>{
            if(e.key!=="Enter")return;
            if(i.value.toUpperCase()===a){
                l.className="light green";
                i.disabled=true;
                checkQuiz();
            } else l.className="light red";
        };
        d.append(i,l);
        quiz.appendChild(d);
    });
}

function checkQuiz(){
    if([...document.querySelectorAll(".light")]
        .every(l=>l.classList.contains("green"))){
        startCode5();
    }
}

function startCode5(){
    timerDisplay.style.display="none";
    document.body.innerHTML="<pre style='color:red'>SYSTEM FAILURE\nPRESS F</pre>";
    document.addEventListener("keydown",e=>{
        if(e.key.toUpperCase()==="F") location.reload();
    });
}

typeText(
`
АГЕНТЕ [ІМʼЯ], 
якщо ви читаєте це повідомлення — значить система дала збій. 

Або ми. 
Або ви.

Аналітичний Відділ фіксує аномальну активність, повʼязану з кодовою назвою GREEN OGRE.

Спочатку це виглядало як жарт.
Потім — як серія безглуздих артефактів.
А тепер — як загроза, природу якої ми не до кінця розуміємо.

У матеріалах фігурують:
– огр зеленого кольору
– тварини, які не повинні бути тут
– предмети, що не мають сенсу
– і ви

Ми не знаємо, чому саме ви були обрані.
Але всі попередні кандидати не витримали абсурду.

Для отримання доступу до Обʼєкта Ω вам необхідно пройти 6 етапів перевірки.

Шукай приховане серед того що бачиш, не довіряй друзям, власним очам, лише своєму павучому відчуттю.
Десь серед УСЬОГО тексту, який буде зустрчатися тобі будуть скриті посилання, частинки пазлів і гумору.

Ми довіряємо цю місію тобі, лише тобі. Ніхто інший не зможе впоратися з цим завданням. Цей текст немає жодного значення, просто
треба щоб він виглядав круто й загадково. Єдинне що дійсно важливе, і сподіваюсь ти це не пропустиш, це час. Він спливає, так швидко, 
що навіть твій друг не може зробити щось корисне бо постійно з тобою грає. Так от, агенту, якщо він закінчиться, ти ніколи не дійдеш до фінального
етапу, і це означає що ти повільний лохобан, тому Сося передає привіт, і можеш починати.

Не шукайте логіку.
Почніть з Конверта №1.
`,
startTimer
);
</script>

</body>
</html>
